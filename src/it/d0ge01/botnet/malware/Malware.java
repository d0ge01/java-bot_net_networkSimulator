package it.d0ge01.botnet.malware;

import it.d0ge01.botnet.net.NetNode;
import it.d0ge01.botnet.protocol.Packet;

import java.util.Vector;

public class Malware {
	private NetNode host;
	public Malware(NetNode host) {
		this.host = host;
	}
	
	public void runtime() {
		while ( true ) {
			this.recv();
			this.host.sendToNet("192.168.1.4", "HI BOTMASTER");
			try {
				Thread.sleep(1000);
			} catch (InterruptedException e) {
				// TODO Auto-generated catch block
				e.printStackTrace();
			}
		}
	}
	
	private void recv() {
		System.out.println("recv invoked");
		Vector v = this.host.read();
		if ( v != null ) {
			for ( int i = 0 ; i < v.size() ; i++ ) {
				System.out.println("Pck one : " + ((Packet) v.get(i)).txt());
				if(((Packet) v.get(i)).txt().equals("HI BOTMASTER")) {
					this.host.sendToNet(((Packet) v.get(i)).dest(), "HELO");
					System.out.println("Push packet respose [botmaster]");
				}
			}
		} else {
			System.out.println("nulled");
		}
	}
	
}
